{
	"app-id": "com.moonlight_stream.Moonlight",
	"runtime": "org.kde.Platform",
	"runtime-version": "5.13",
	"sdk": "org.kde.Sdk",
	"command": "moonlight",
	"rename-icon": "moonlight",
	"finish-args": [
		"--share=network",
		"--socket=x11",
		"--socket=wayland",
		"--share=ipc",
		"--socket=pulseaudio",
		"--device=all",
		"--env=LIBVA_DRIVER_NAME=",
		"--env=LIBVA_DRIVERS_PATH="
	],
	"cleanup": [
		"/include",
		"*.a",
		"*.la",
		"*.pc"
	],
	"modules": [
		{
			"name": "SDL2",
			"build-options": {
				"config-opts": [
					"--prefix=/app",
					"--enable-sdl-dlopen",
					"--disable-arts",
					"--disable-esd",
					"--disable-nas",
					"--disable-alsa",
					"--disable-oss",
					"--disable-sndio",
					"--disable-libudev",
					"--enable-video-wayland",
					"--enable-wayland-shared=no",
					"--disable-rpath"
				]
			},
			"sources": [
				{
					"type": "archive",
					"url": "https://libsdl.org/release/SDL2-2.0.10.tar.gz",
					"sha256": "b4656c13a1f0d0023ae2f4a9cf08ec92fffb464e0f24238337784159b8b91d57"
				},
				{
					"type": "patch",
					"path": "patches/joystick_enumeration_delay.patch"
				}
			]
		},
		{
			"name": "ffnvcodec",
			"no-autogen": true,
			"only-arches": [
				"i386",
				"x86_64"
			],
			"make-install-args": [
				"PREFIX=/app"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://git.videolan.org/git/ffmpeg/nv-codec-headers.git",
					"tag": "n8.1.24.11",
					"commit": "0cd5c2b7c30d580d09348c92d8facd7a39957f01"
				}
			]
		},
		{
			"name": "rpi-userland",
			"buildsystem": "cmake",
			"config-opts": [
				"-DVMCS_INSTALL_PREFIX=/app"
			],
			"only-arches": [
				"arm",
				"aarch64"
			],
			"cleanup": [
				"/bin",
				"/src",
				"/lib/libbrcm*.so",
				"/lib/libEGL.so",
				"/lib/libGLESv2.so",
				"/lib/libopenmaxil.so",
				"/lib/libOpenVG.so",
				"/lib/libWFC.so",
				"/lib/plugins"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/raspberrypi/userland.git",
					"commit": "06bc6daa02137ca72b7a2104afad81e82a44de17"
				}
			]
		},
		{
			"name": "ffmpeg",
			"build-options": {
				"config-opts": [
					"--enable-pic",
					"--enable-static",
					"--disable-shared",
					"--disable-all",
					"--enable-avcodec",
					"--enable-decoder=h264",
					"--enable-decoder=hevc",
					"--enable-hwaccel=h264_vaapi",
					"--enable-hwaccel=hevc_vaapi",
					"--enable-hwaccel=h264_vdpau",
					"--enable-hwaccel=hevc_vdpau"
				],
				"arch": {
					"x86_64": {
						"config-opts": [
							"--enable-nvdec",
							"--enable-hwaccel=h264_nvdec",
							"--enable-hwaccel=hevc_nvdec"
						]
					},
					"i386": {
						"config-opts": [
							"--enable-nvdec",
							"--enable-hwaccel=h264_nvdec",
							"--enable-hwaccel=hevc_nvdec"
						]
					},
					"arm": {
						"config-opts": [
							"--enable-mmal",
							"--enable-decoder=h264_mmal"
						]
					},
					"aarch64": {
						"config-opts": [
							"--enable-mmal",
							"--enable-decoder=h264_mmal"
						]
					}
				}
			},
			"cleanup": [
				"/share/ffmpeg"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://ffmpeg.org/releases/ffmpeg-4.2.2.tar.bz2",
					"sha256": "b620d187c26f76ca19e74210a0336c3b8380b97730df5cdf45f3e69e89000e5c"
				}
			]
		},
		{
			"name": "moonlight",
			"buildsystem": "qmake",
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/moonlight-stream/moonlight-qt.git",
					"tag": "v1.2.0",
					"commit": "973d174a306428c285bd56389f401aee803e4846"
				}
			]
		}
	]
}
